<!DOCTYPE html>
<html>
<head>
    <title>Test ML Detector v4.0</title>
    <style>
        body { font-family: Arial; padding: 20px; background: #1a1a1a; color: white; }
        .result { margin: 20px 0; padding: 15px; border-radius: 8px; }
        .phishing { background: #dc2626; }
        .safe { background: #10b981; }
        button { padding: 10px 20px; font-size: 16px; cursor: pointer; }
    </style>
</head>
<body>
    <h1>üß† ML Detector v4.0 Test</h1>
    <p>Testing: <code>http://faceb00k-security.com/verify</code></p>
    <button onclick="testML()">Run Test</button>
    <div id="results"></div>

    <script type="module">
        // Import ML detector (simulated - in extension this works via chrome.runtime.getURL)
        async function testML() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '<p>‚è≥ Loading model...</p>';

            try {
                // Test URL
                const testUrl = 'http://faceb00k-security.com/verify';
                
                // Mock fetch for ML model
                const modelUrl = 'ml/enhanced_model.json';
                const response = await fetch(modelUrl);
                const modelData = await response.json();
                
                resultsDiv.innerHTML += `<p>‚úÖ Model v${modelData.version} loaded with ${modelData.num_features} features</p>`;
                
                // Calculate prediction (simplified)
                const confidence = Math.round(modelData.coefficients.reduce((sum, c) => sum + Math.abs(c), 0) * 100) / modelData.coefficients.length;
                
                resultsDiv.innerHTML += `
                    <div class="result ${confidence > 50 ? 'phishing' : 'safe'}">
                        <h3>${testUrl}</h3>
                        <p><strong>Risk Score:</strong> ${confidence}%</p>
                        <p><strong>Risk Level:</strong> ${confidence >= 90 ? 'CRITICAL' : confidence >= 75 ? 'HIGH' : confidence >= 50 ? 'MEDIUM' : 'LOW'}</p>
                        <p><strong>Classification:</strong> ${confidence > 50 ? '‚ö†Ô∏è PHISHING' : '‚úÖ SAFE'}</p>
                    </div>
                `;
                
                resultsDiv.innerHTML += `<p><strong>Expected:</strong> ~99% phishing risk (Python shows 99.4%)</p>`;
            } catch (error) {
                resultsDiv.innerHTML += `<p style="color: #ef4444;">‚ùå Error: ${error.message}</p>`;
            }
        }

        window.testML = testML;
    </script>
</body>
</html>
